var Playtomic={};(function(){var Temp={};var SWFID=0;var GUID="";var Enabled=true;var SourceUrl="";var BaseUrl="";var APIUrl="";var APIKey="";var Pings=0;var FailCount=0;var ScriptHolder=null;var Beacon=new Image();var URLStub="";var URLTail="";var SECTIONS={};var ACTIONS={};(function(){var Request=new LogRequest();var Plays=0;var Pings=0;var FirstPing=true;var Frozen=false;var FrozenQueue=[];var Customs=[];var LevelCounters=[];var LevelAverages=[];var LevelRangeds=[];function Send(data,forcesend){if(Frozen){FrozenQueue.push(data);return}if(Request==null){Request=LogRequest()}Request.Queue(data);if(Request.Ready||forcesend){Request.Send();Request=new LogRequest()}}function Ping(){if(!Enabled)return;Pings++;Send("t/"+(FirstPing?"y":"n")+"/"+Pings,true);if(FirstPing){setInterval(Ping,30000);FirstPing=false}}function Clean(s){if(s==null||s=="")return"";s=s.toString();while(s.indexOf("/")>-1)s=s.replace("/","\\");while(s.indexOf("~")>-1)s=s.replace("~","-");return escape(s)}function Unescape(s){return decodeURI(s).replace(/\+/g," ")}function SetCookie(key,value){var expires=new Date();expires.setDate(expires.getDate()+30);document.cookie=key+"="+escape(value)+";expires="+expires.toUTCString()}function GetCookie(key){if(document.cookie.length==0)return 0;var start=document.cookie.indexOf(key+"=");if(start==-1)return 0;start=start+key.length+1;var end=document.cookie.indexOf(";",start);if(end==-1)end=document.cookie.length;return unescape(document.cookie.substring(start,end))}Playtomic.Log={View:function(swfid,guid,apikey,defaulturl){if(SWFID>0)return;SWFID=swfid;GUID=guid;Enabled=true;if(SWFID==0||GUID==""){Enabled=false;return}SourceUrl=defaulturl?defaulturl:document.location;BaseUrl=SourceUrl.split("://")[1];if(BaseUrl.indexOf("/")>-1)BaseUrl=BaseUrl.substring(0,BaseUrl.indexOf("/"));URLStub="http://g"+GUID+".api2.playtomic.com/";URLTail="swfid="+SWFID+"&js=y";SECTIONS={"gamevars":Encode.MD5("gamevars-"+apikey),"geoip":Encode.MD5("geoip-"+apikey),"leaderboards":Encode.MD5("leaderboards-"+apikey),"playerlevels":Encode.MD5("playerlevels-"+apikey),"data":Encode.MD5("data-"+apikey),"parse":Encode.MD5("parse-"+apikey)};ACTIONS={"gamevars-load":Encode.MD5("gamevars-load-"+apikey),"geoip-lookup":Encode.MD5("geoip-lookup-"+apikey),"leaderboards-list":Encode.MD5("leaderboards-list-"+apikey),"leaderboards-listfb":Encode.MD5("leaderboards-listfb-"+apikey),"leaderboards-save":Encode.MD5("leaderboards-save-"+apikey),"leaderboards-savefb":Encode.MD5("leaderboards-savefb-"+apikey),"leaderboards-saveandlist":Encode.MD5("leaderboards-saveandlist-"+apikey),"leaderboards-saveandlistfb":Encode.MD5("leaderboards-saveandlistfb-"+apikey),"leaderboards-createprivateleaderboard":Encode.MD5("leaderboards-createprivateleaderboard-"+apikey),"leaderboards-loadprivateleaderboard":Encode.MD5("leaderboards-loadprivateleaderboard-"+apikey),"playerlevels-save":Encode.MD5("playerlevels-save-"+apikey),"playerlevels-load":Encode.MD5("playerlevels-load-"+apikey),"playerlevels-list":Encode.MD5("playerlevels-list-"+apikey),"playerlevels-rate":Encode.MD5("playerlevels-rate-"+apikey),"data-views":Encode.MD5("data-views-"+apikey),"data-plays":Encode.MD5("data-plays-"+apikey),"data-playtime":Encode.MD5("data-playtime-"+apikey),"data-custommetric":Encode.MD5("data-custommetric-"+apikey),"data-levelcountermetric":Encode.MD5("data-levelcountermetric-"+apikey),"data-levelrangedmetric":Encode.MD5("data-levelrangedmetric-"+apikey),"data-levelaveragemetric":Encode.MD5("data-levelaveragemetric-"+apikey),"parse-save":Encode.MD5("parse-save-"+apikey),"parse-delete":Encode.MD5("parse-delete-"+apikey),"parse-load":Encode.MD5("parse-load-"+apikey),"parse-find":Encode.MD5("parse-find-"+apikey)};ScriptHolder=document.createElement("div");ScriptHolder.style.position="absolute";document.getElementsByTagName("body")[0].appendChild(ScriptHolder);var views=GetCookie("views");views++;SetCookie("views",views);Send("v/"+views,true);setTimeout(Ping,60000)},Play:function(){if(!Enabled)return;LevelCounters=[];LevelAverages=[];LevelRangeds=[];Plays++;Send("p/"+Plays)},Link:function(name,group,url,unique,total,fail){if(!Enabled)return;Send("l/"+Clean(name)+"/"+Clean(group)+"/"+Clean(url)+"/"+unique+"/"+total+"/"+fail)},CustomMetric:function(name,group,unique){if(!Enabled)return;if(group==null||group==undefined)group="";if(unique){if(Customs.indexOf(name)>-1)return;Customs.push(name)}Send("c/"+Clean(name)+"/"+Clean(group))},LevelCounterMetric:function(name,level,unique){if(!Enabled)return;if(unique){var key=name+"."+level.toString();if(LevelCounters.indexOf(key)>-1)return;LevelCounters.push(key)}Send("lc/"+Clean(name)+"/"+Clean(level))},LevelRangedMetric:function(name,level,value,unique){if(!Enabled)return;if(unique){var key=name+"."+level.toString();if(LevelRangeds.indexOf(key)>-1)return;LevelRangeds.push(key)}Send("lr/"+Clean(name)+"/"+Clean(level)+"/"+value)},LevelAverageMetric:function(name,level,value,unique){if(!Enabled)return;if(unique){var key=name+"."+level.toString();if(Log.LevelAverages.indexOf(key)>-1)return;LevelAverages.push(key)}Send("la/"+Clean(name)+"/"+Clean(level)+"/"+value)},Heatmap:function(metric,heatmap,x,y){if(!Enabled)return;Send("h/"+Clean(metric)+"/"+Clean(heatmap)+"/"+x+"/"+y)},Funnel:function(name,step,stepnum){if(!Enabled)return;Send("f/"+Clean(name)+"/"+Clean(step)+"/"+num)},PlayerLevelStart:function(levelid){if(!Enabled)return;Send("pls/"+levelid)},PlayerLevelWin:function(levelid){if(!Enabled)return;Send("plw/"+levelid)},PlayerLevelQuit:function(levelid){if(!Enabled)return;Send("plq/"+levelid)},PlayerLevelRetry:function(levelid){if(!Enabled)return;Send("plr/"+levelid)},PlayerLevelFlag:function(levelid){if(!Enabled)return;Send("plf/"+levelid)},ForceSend:function(){if(!Enabled)return;if(Request==null)Request=new LogRequest();Request.Send();Request=new LogRequest()},Freeze:function(){Frozen=true},UnFreeze:function(){Frozen=false;if(FrozenQueue.length>0){Request.MassQueue()}}};function LogRequest(){var Data=[];var Ready=false;this.Queue=function(data){Data.push(data);if(Data.length>8){Ready=true}};this.Send=function(){var s=document.createElement("script");s.async=true;s.src=URLStub+"tracker/q.aspx?swfid="+SWFID+"&q="+Data.join("~")+"&url="+SourceUrl+"&"+Math.random()+"z";ScriptHolder.innerHTML="";ScriptHolder.appendChild(s)};this.MassQueue=function(frozenqueue){if(frozenqueue.length==0){Log.Request=this;return}for(var i=frozenqueue.length-1;i>-1;i--){Queue(frozenqueue[i]);frozenqueue.splice(i,1);if(Ready){Send();var request=new LogRequest();request.MassQueue(frozenqueue);return}}}}}());(function(){var Clicks=[];Playtomic.Link={Track:function(url,name,group){var unique=0;var bunique=0;var total=0;var btotal=0;var fail=0;var bfail=0;var key=url+"."+name;var result;var baseurl=url;baseurl=baseurl.replace("http://","");if(baseurl.indexOf("/")>-1)baseurl=baseurl.substring(0,baseurl.indexOf("/"));if(baseurl.indexOf("?")>-1)baseurl=baseurl.substring(0,baseurl.indexOf("?"));baseurl="http://"+baseurl+"/";var baseurlname=baseurl;if(baseurlname.indexOf("//")>-1)baseurlname=baseurlname.substring(baseurlname.indexOf("//")+2);baseurlname=baseurlname.replace("www.","");if(baseurlname.indexOf("/")>-1){baseurlname=baseurlname.substring(0,baseurlname.indexOf("/"))}if(Clicks.indexOf(key)>-1){total=1}else{total=1;unique=1;Clicks.push(key)}if(Clicks.indexOf(baseurlname)>-1){btotal=1}else{btotal=1;bunique=1;Clicks.push(baseurlname)}Playtomic.Log.Link(baseurl,baseurlname.toLowerCase(),"DomainTotals",bunique,btotal,bfail);Playtomic.Log.Link(url,name,group,unique,total,fail);Playtomic.Log.ForceSend()},Open:function(url,name,group){var page=window.open(url,"_blank");this.Track(url,name,group)}}}());(function(){Playtomic.PlayerLevels={POPULAR:"popular",NEWEST:"newest",Save:function(level,callback){var postdata={};postdata.nothumb=true;postdata.playerid=level.PlayerId;postdata.playersource=level.PlayerSource;postdata.playername=level.PlayerName;postdata.name=level.Name;var c=0;if(level.CustomData){for(var key in level.CustomData){postdata["ckey"+c]=key;postdata["cdata"+c]=level.CustomData[key];c++}}postdata.customfields=c;postdata.data=level.Data;SendAPIRequest(SECTIONS["playerlevels"],ACTIONS["playerlevels-save"],SaveComplete,callback,postdata)},Load:function(levelid,callback){var postdata={};postdata.levelid=levelid;SendAPIRequest(SECTIONS["playerlevels"],ACTIONS["playerlevels-load"],LoadComplete,callback,postdata)},List:function(callback,options){if(options==null)options=new Object();var postdata={};postdata.mode=options.mode?options.mode:"popular";postdata.page=options.page?options.page:1;postdata.perpage=options.perpage?options.perpage:20;postdata.data=options.data||options.data==false?(options.data?"y":"n"):"n";postdata.thumbs="n";postdata.datemin=options.datemin?options.datemin:"";postdata.datemax=options.datemax?options.datemax:"";var customfilters=options.hasOwnProperty("customfilters")?options["customfilters"]:{};var c=0;for(var key in customfilters){postdata["ckey"+c]=key;postdata["cdata"+c]=level.CustomData[key];c++}postdata.filters=c;SendAPIRequest(SECTIONS["playerlevels"],ACTIONS["playerlevels-list"],ListComplete,callback,postdata)},Rate:function(levelid,rating,callback){var postdata={};postdata.levelid=levelid;postdata.rating=rating;SendAPIRequest(SECTIONS["playerlevels"],ACTIONS["playerlevels-rate"],RateComplete,callback,postdata)},LogStart:function(levelid){Playtomic.Log.PlayerLevelStart(levelid)},LogQuit:function(levelid){Playtomic.Log.PlayerLevelQuit(levelid)},LogWin:function(levelid){Playtomic.Log.PlayerLevelWin(levelid)},LogRetry:function(levelid){Playtomic.Log.PlayerLevelRetry(levelid)},Flag:function(levelid){Playtomic.Log.PlayerLevelFlag(levelid)}};function SaveComplete(callback,postdata,data,response){if(callback==null)return;callback(data.LevelId,response)}function LoadComplete(callback,postdata,data,response){if(callback==null)return;callback(data,response)}function ListComplete(callback,postdata,data,response){if(callback==null)return;callback(data.Levels,data.NumLevels,response)};function RateComplete(callback,postdata,data,response){if(callback==null)return;callback(response)}}());(function(){Playtomic.Leaderboards={TODAY:"today",LAST7DAYS:"last7days",LAST30DAYS:"last30days",ALLTIME:"alltime",NEWEST:"newest",List:function(table,callback,options){if(options==null)options=new Object();var highest=options.highest||options.highest==false?options.highest:true;var facebook=options.facebook||options.facebook==false?options.facebook:false;var postdata={};postdata.highest=highest?"y":"n";postdata.facebook=facebook?"y":"n";postdata.mode=options.mode?options.mode:"alltime";postdata.page=options.page?options.page:1;postdata.perpage=options.perpage?options.perpage:20;var customfilters=options.customfilters?options.customfilters:{};var numcustomfilters=0;for(var x in customfilters){postdata["ckey"+numcustomfilters]=x;postdata["cdata"+numcustomfilters]=customfilters[x];numcustomfilters++}var global=options.global||options.global==false?options.global:true;postdata.url=(global?"global":SourceUrl);postdata.table=table;postdata.filters=numcustomfilters;var action="leaderboards-list";if(facebook){var friendslist=options.friendslist?options.friendslist:[];if(friendslist.length>0){postdata.friendslist=friendslist.join(",")}action+="fb"}SendAPIRequest(SECTIONS["leaderboards"],ACTIONS[action],ListComplete,callback,postdata)},Save:function(score,table,callback,options){if(options==null)options=new Object();var allowduplicates=options.allowduplicates||options.allowduplicates==false?options.allowduplicates:false;var highest=highest=options.highest||options.highest==false?options.highest:true;var postdata={};postdata.allowduplicates=allowduplicates?"y":"n";postdata.highest=highest?"y":"n";postdata.table=table;postdata.name=score.Name;postdata.points=score.Points.toString();postdata.auth=Encode.MD5(SourceUrl+score.Points.toString());postdata.url=SourceUrl;if(score.FBUserId!=null&&score.FBUserId!=""){postdata.fbuserid=score.FBUserId;postdata.fb="y"}else{postdata.fbuserid="";postdata.fb="n"}var c=0;if(score.CustomData){for(var key in score.CustomData){postdata["ckey"+c]=key;postdata["cdata"+c]=score.CustomData[key];c++}}postdata.customfields=c;SendAPIRequest(SECTIONS["leaderboards"],ACTIONS["leaderboards-save"],SaveComplete,callback,postdata)},SaveAndList:function(score,table,callback,saveoptions,listoptions){var postdata={};postdata.table=table;var allowduplicates=saveoptions.allowduplicates||saveoptions.allowduplicates==false?saveoptions.allowduplicates:false;var highest=saveoptions.highest||saveoptions.highest==false?saveoptions.highest:true;var facebook=saveoptions.facebook||saveoptions.facebook==false?saveoptions.facebook:false;if(saveoptions==null)saveoptions=new Object();postdata.allowduplicates=allowduplicates?"y":"n";postdata.highest=highest?"y":"n";postdata.facebook=facebook?"y":"n";postdata.name=score.Name;postdata.points=score.Points.toString();postdata.auth=Encode.MD5(SourceUrl+score.Points.toString());postdata.url=SourceUrl;if(score.FBUserId!=null&&score.FBUserId!=""){postdata.fbuserid=score.FBUserId;postdata.fb="y"}else{postdata.fbuserid="";postdata.fb="n"}var c=0;if(score.CustomData){for(var key in score.CustomData){postdata["ckey"+c]=key;postdata["cdata"+c]=score.CustomData[key];c++}}postdata.numfields=c;if(listoptions==null)listoptions=new Object();var global=listoptions.global||listoptions.global==false?listoptions.global:true;postdata.global=global?"y":"n";postdata.mode=listoptions.mode?listoptions.mode:"alltime";postdata.perpage=listoptions.perpage?listoptions.perpage:20;var customfilters=listoptions.customfilters?listoptions.customfilters:{};var numcustomfilters=0;if(customfilters!=null){for(var key in customfilters){postdata["lkey"+numcustomfilters]=key;postdata["ldata"+numcustomfilters]=customfilters[key];numcustomfilters++}}postdata.numfilters=numcustomfilters;var action="leaderboards-saveandlist";if(facebook){var friendslist=options.friendslist?options.friendslist:[];if(friendslist.length>0){postdata.friendslist=friendslist.join(",")}action+="fb"}SendAPIRequest(SECTIONS["leaderboards"],ACTIONS[action],ListComplete,callback,postdata)},CreatePrivateLeaderboard:function(table,permalink,callback,highest){var postdata={};postdata.table=table;postdata.highest=(highest?"y":"n");postdata.permalink=permalink;SendAPIRequest(SECTIONS["leaderboards"],ACTIONS["leaderboards-createprivateleaderboard"],CreatePrivateLeaderboardComplete,callback,postdata)},LoadPrivateLeaderboard:function(tableid,callback){var postdata={};postdata.tableid=tableid;SendAPIRequest(SECTIONS["leaderboards"],ACTIONS["leaderboards-loadprivateleaderboard"],CreatePrivateLeaderboardComplete,callback,postdata)}};function ListComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback([],0,response)}var scores=[];var arr=data.Scores;for(var i=0;i<arr.length;i++){var score={};score.Name=unescape(arr[i].Name);score.FBUserId=arr[i].FBUserId;score.Points=arr[i].Points;score.Website=arr[i].Website;score.SDate=arr[i].SDate;score.RDate=arr[i].RDate;score.Rank=arr[i].Rank;if(arr[i]["SubmittedOrBest"]!=null){score.SubmittedOrBest=arr[i].SubmittedOrBest=="true"}else{score.SubmittedOrBest=false}score.CustomData={};for(x in arr[i].CustomData)score.CustomData[x]=unescape(arr[i].CustomData[x]);scores[i]=score}callback(scores,data.NumScores,response)}function SaveComplete(callback,postdata,data,response){if(callback==null)return;callback(response)}function CreatePrivateLeaderboardComplete(callback,postdata,data,response){if(response.Success==false){callback({},response)}var leaderboard={TableId:data.TableId,Name:data.Name,Permalink:data.Permalink,Bitly:data.Bitly,RealName:data.RealName};callback(leaderboard,response)}}());(new function(){Playtomic.Data={Views:function(callback,options){General(ACTIONS["data-views"],"views",callback,options)},Plays:function(callback,options){General(ACTIONS["data-plays"],"plays",callback,options)},PlayTime:function(callback,options){General(ACTIONS["data-playtime"],"playtime",callback,options)},CustomMetric:function(metric,callback,options){if(options==null)options={};var postdata={};postdata.day=options.day?options.day:0;postdata.month=options.month?options.month:0;postdata.year=options.year?options.year:0;SendAPIRequest(SECTIONS["data"],ACTIONS["data-custommetric"],CustomMetricComplete,callback,postdata)},LevelCounterMetric:function(metric,level,callback,options){LevelMetric(ACTIONS["data-levelcountermetric"],metric,level,LevelCounterMetricComplete,callback,options)},LevelRangedMetric:function(metric,level,callback,options){LevelMetric(ACTIONS["data-levelrangedmetric"],metric,level,LevelRangedMetricComplete,callback,options)},LevelAverageMetric:function(metric,level,callback,options){LevelMetric(ACTIONS["data-levelaveragemetric"],metric,level,LevelAverageMetricComplete,callback,options)}};function General(action,type,callback,options){if(options==null)options={};var postdata={};postdata.type=type;postdata.day=options.day?options.day:0;postdata.month=options.month?options.month:0;postdata.year=options.year?options.year:0;SendAPIRequest(SECTIONS["data"],action,GeneralComplete,callback,postdata)}function GeneralComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}var result={Name:postdata.type,Day:postdata.day,Month:postdata.month,Year:postdata.year,Value:data.Value};callback(result,response)}function CustomMetricComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}var result={Name:"custommetric",Day:postdata.day,Month:postdata.month,Year:postdata.year,Value:data.Value};callback(result,response)}function LevelMetric(action,metric,level,complete,callback,options){if(options==null)options={};var postdata={};postdata.metric=metric;postdata.level=level;postdata.day=options.day?options.day:0;postdata.month=options.month?options.month:0;postdata.year=options.year?options.year:0;SendAPIRequest(SECTIONS["data"],action,complete,callback,postdata)}function LevelCounterMetricComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}var result={Name:"levelcountermetric",Metric:metric,Level:level,Day:day,Month:month,Year:year,Value:data.Value};callback(result,response)};function LevelRangedMetricComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}var result={Name:"levelrangedmetric",Metric:metric,Level:level,Day:day,Month:month,Year:year,Data:data.Values};callback(result,response)}function LevelAverageMetricComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}var result={Name:"levelaveragemetric",Metric:metric,Level:level,Day:day,Month:month,Year:year,Min:data.Min,Max:data.Max,Average:data.Average,Total:data.Total};callback(data,response)}}());(new function(){Playtomic.GeoIP={Lookup:function(callback){SendAPIRequest(SECTIONS["geoip"],ACTIONS["geoip-lookup"],LookupComplete,callback,null)}};function LookupComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}callback(data,response)}}());(new function(){Playtomic.GameVars={Load:function(callback){SendAPIRequest(SECTIONS["gamevars"],ACTIONS["gamevars-load"],LoadComplete,callback,null)}};function LoadComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}callback(data,response)}}());Playtomic.PFObject=function(){this.ObjectId="";this.ClassName="";this.Pointers=[];this.Data={};this.UpdatedAt=null;this.CreatedAt=null;this.Password=""};Playtomic.PFQuery=function(){this.ClassName="";this.WherePointers=[];this.WhereData={};this.Order="";this.Limit=10};Playtomic.PFPointer=function(fieldname,po){this.FieldName=fieldname;this.PObject=po};(function(){Playtomic.Parse={Save:function(pobject,callback){SendAPIRequest(SECTIONS["parse"],ACTIONS["parse-save"],SaveComplete,callback,ObjectPostData(pobject))},Delete:function(pobject,callback){SendAPIRequest(SECTIONS["parse"],ACTIONS["parse-delete"],DeleteComplete,callback,ObjectPostData(pobject))},Load:function(pobjectid,classname,callback){var postdata={};postdata.id=pobjectid;postdata.classname=classname;SendAPIRequest(SECTIONS["parse"],ACTIONS["parse-load"],LoadComplete,callback,postdata)},Find:function(pquery,callback){var postdata={};postdata.classname=pquery.ClassName;postdata.limit=pquery.Limit;postdata.order=(pquery.Order!=null&&pquery.Order!=""?pquery.Order:"created_at");for(var key in pquery.WhereData)postdata["data"+key]=pquery.WhereData[key];for(var pointer in pquery.WherePointers){postdata["pointer"+i+"fieldname"]=pointer.FieldName;postdata["pointer"+i+"classname"]=pointer.PObject.ClassName;postdata["pointer"+i+"id"]=pointer.PObject.ObjectId}SendAPIRequest(SECTIONS["parse"],ACTIONS["parse-find"],FindComplete,callback,postdata)}};function ObjectPostData(pobject){var postdata={};postdata.classname=pobject.ClassName;postdata.id=(pobject.ObjectId==null?"":pobject.ObjectId);postdata.password=(pobject.Password==null?"":pobject.Password);for(var key in pobject.Data)postdata["data"+key]=pobject.Data[key];for(var pointer in pobject.Pointers){postdata["pointer"+i+"fieldname"]=pointer.FieldName;postdata["pointer"+i+"classname"]=pointer.PObject.ClassName;postdata["pointer"+i+"id"]=pointer.PObject.ObjectId}return postdata}function SaveComplete(callback,postdata,data,response){if(callback==null)return;var po=new Playtomic.PFObject();po.ClassName=postdata.className;po.ObjectId=postdata.id;po.Password=postdata.password;for(var key in postdata){if(key.indexOf("data")==0){po.Data[key.substring(4)]=postdata[key]}if(key.indexOf("pointer")==0&&key.indexOf("fieldname")>-1){var n=key.substring(7);n=n.substring(0,n.indexOf("fieldname"));var pchild=new Playtomic.PFObject();pchild.ObjectId=postdata["pointer"+n+"id"];pchild.ClassName=postdata["pointer"+n+"classname"];po.Pointers.push(new Playtomic.PFPointer(postdata[key],pchild))}}if(response.Success)po.ObjectId=data.id;callback(po,response)}function LoadComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}var po=new Playtomic.PFObject();po.ClassName=data.classname;po.ObjectId=data.id;po.Password=data.password;po.CreatedAt=DateParse(data.created);po.UpdatedAt=DateParse(data.updated);for(var key in data.fields){po.Data[key]=data.fields[key]}for(var key in data.pointers){var pchild=new Playtomic.PFObject();pchild.ObjectId=data.pointers[key][0];pchild.ClassName=data.pointers[key][1];po.Pointers.push(new Playtomic.PFPointer(key,pchild))}callback(po,response)}function DeleteComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback(null,response);return}callback(data,response)}function FindComplete(callback,postdata,data,response){if(callback==null)return;if(response.Success==false){callback([],response);return}var results=[];for(var i=0;i<data.length;i++){var ptemp=data[i];var po=new Playtomic.PFObject();po.ClassName=ptemp.classname;po.ObjectId=ptemp.id;po.Password=ptemp.password;po.CreatedAt=DateParse(ptemp.created);po.UpdatedAt=DateParse(ptemp.updated);for(var key in ptemp.fields){po.Data[key]=ptemp.fields[key]}for(var key in ptemp.pointers){var pointer=new Playtomic.PFObject();pointer.ObjectId=ptemp.pointers[key][0];pointer.ClassName=ptemp.pointers[key][1];po.Pointers.push(new Playtomic.PFPointer(key,pointer))}results.push(po)}callback(results,response)}function DateParse(date){var parts=date.split(" ");var dateparts=(parts[0].toString()).split("/");var timeparts=(parts[1].toString()).split(":");var day=parseInt(dateparts[1]);var month=parseInt(dateparts[0]);var year=parseInt(dateparts[2]);var hours=parseInt(timeparts[0]);var minutes=parseInt(timeparts[1]);var seconds=parseInt(timeparts[2]);return new Date(Date.UTC(year,month,day,hours,minutes,seconds))}}());function Escape(str){if(str==null)return"";str=str.toString();str=str.split("%").join("%25");str=str.split(";").join("%3B");str=str.split("?").join("%3F");str=str.split("/").join("%2F");str=str.split(":").join("%3A");str=str.split("#").join("%23");str=str.split("&").join("%26");str=str.split("=").join("%3D");str=str.split("+").join("%2B");str=str.split("$").join("%24");str=str.split(",").join("%2C");str=str.split(" ").join("%20");str=str.split("<").join("%3C");str=str.split(">").join("%3E");str=str.split("~").join("%7E");return str}function SendAPIRequest(section,action,complete,callback,postdata){var url=URLStub+"v3/api.aspx?"+URLTail+"&r="+Math.random()+"Z";var timestamp=String(new Date().getTime()).substring(0,10);var nonce=Encode.MD5(new Date().getTime()*Math.random()+GUID);var pd=new Array();pd.push("nonce="+nonce);pd.push("timestamp="+timestamp);for(var key in postdata)pd.push(key+"="+Escape(postdata[key]));GenerateKey("section",section,pd);GenerateKey("action",action,pd);GenerateKey("signature",nonce+timestamp+section+action+url+GUID,pd);var pda="data="+Escape(Encode.Base64(pd.join("&")));var request=window.XDomainRequest?new XDomainRequest():new XMLHttpRequest();request.onerror=function(){complete(callback,postdata,{},Response(0,1))};request.onload=function(){var data=JSON.parse(request.responseText);complete(callback,postdata,data.Data,Response(data.Status,data.ErrorCode))};if(window.XDomainRequest){request.open("POST",url)}else{request.open("POST",url,true)}request.send(pda)}var ERRORS={"0":"No error","1":"General error, this typically means the player is unable to connect to the Playtomic servers","2":"Invalid game credentials. Make sure you use your SWFID and GUID from the `API` section in the dashboard.","3":"Request timed out.","4":"Invalid request.","100":"GeoIP API has been disabled. This may occur if your game is faulty or overwhelming the Playtomic servers.","200":"Leaderboard API has been disabled. This may occur if your game is faulty or overwhelming the Playtomic servers.","201":"The source URL or name weren't provided when saving a score. Make sure the player specifies a name and the game is initialized before anything else using the code in the `Set your game up` section.","202":"Invalid auth key. You should not see this normally, players might if they tamper with your game.","203":"No Facebook user id on a score specified as a Facebook submission.","204":"Table name wasn't specified for creating a private leaderboard.","205":"Permalink structure wasn't specified: http://website.com/game/whatever?leaderboard=","206":"Leaderboard id wasn't provided loading a private leaderboard.","207":"Invalid leaderboard id was provided for a private leaderboard.","208":"Player is banned from submitting scores in your game.","209":"Score was not the player's best score.  You can notify the player, highlight their best score via score.SubmittedOrBest, or circumvent this by specifying 'allowduplicates' to be true in your save options.","300":"GameVars API has been disabled. This may occur if your game is faulty or overwhelming the Playtomic servers.","400":"Level sharing API has been disabled. This may occur if your game is faulty or overwhelming the Playtomic servers.","401":"Invalid rating value (must be 1 - 10).","402":"Player has already rated that level.","403":"The level name wasn't provided when saving a level.","404":"Invalid image auth. You should not see this normally, players might if they tamper with your game.","405":"Invalid image auth (again). You should not see this normally, players might if they tamper with your game.","500":"Data API has been disabled. This may occur if the Data API is not enabled for your game, or your game is faulty or overwhelming the Playtomic servers.","600":"You have not configured your Parse.com database.  Sign up at Parse and then enter your API credentials in your Playtomic dashboard.","601":"No response was returned from Parse.  If you experience this a lot let us know exactly what you're doing so we can sort out a fix for it.","6021":"Parse's servers had an error.","602101":"Object not found.  Make sure you include the classname and objectid and that they are correct.","602102":"Invalid query.  If you think you're doing it right let us know what you're doing and we'll look into it.","602103":"Invalid classname.","602104":"Missing objectid.","602105":"Invalid key name.","602106":"Invalid pointer.","602107":"Invalid JSON.","602108":"Command unavailable."};function Response(status,errorcode){return{Success:status==1,ErrorCode:errorcode,ErrorMessage:ERRORS[errorcode]}};function GenerateKey(name,key,arr){arr.sort();arr.push(name+"="+Encode.MD5(arr.join("&")+key))}function PostData(postdata,script,callback,failvalue){var request;if(window.XDomainRequest){request=new XDomainRequest();request.onerror=function(){callback(failvalue)};request.onload=function(){callback(JSON.parse(request.responseText))};if(postdata!=""){request.open("POST",script);request.send(postdata)}else{request.open("GET",script);request.send()}}else{request=new XMLHttpRequest();request.onerror=function(){callback(failvalue)};request.onload=function(){callback(JSON.parse(request.responseText))};if(postdata!=""){request.open("POST",script,true);request.send(postdata)}else{request.open("GET",script,true);request.send()}}}var Encode=(new function(){var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var hex_chr="0123456789abcdef";return{Base64:function(str){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;str=_utf8_encode(str);while(i<str.length){chr1=str.charCodeAt(i++);chr2=str.charCodeAt(i++);chr3=str.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2))enc3=enc4=64;else if(isNaN(chr3))enc4=64;output=output+_keyStr.charAt(enc1)+_keyStr.charAt(enc2)+_keyStr.charAt(enc3)+_keyStr.charAt(enc4)}return output},MD5:function(str){var x=str2blks_MD5(str);var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=ff(a,b,c,d,x[i+0],7,-680876936);d=ff(d,a,b,c,x[i+1],12,-389564586);c=ff(c,d,a,b,x[i+2],17,606105819);b=ff(b,c,d,a,x[i+3],22,-1044525330);a=ff(a,b,c,d,x[i+4],7,-176418897);d=ff(d,a,b,c,x[i+5],12,1200080426);c=ff(c,d,a,b,x[i+6],17,-1473231341);b=ff(b,c,d,a,x[i+7],22,-45705983);a=ff(a,b,c,d,x[i+8],7,1770035416);d=ff(d,a,b,c,x[i+9],12,-1958414417);c=ff(c,d,a,b,x[i+10],17,-42063);b=ff(b,c,d,a,x[i+11],22,-1990404162);a=ff(a,b,c,d,x[i+12],7,1804603682);d=ff(d,a,b,c,x[i+13],12,-40341101);c=ff(c,d,a,b,x[i+14],17,-1502002290);b=ff(b,c,d,a,x[i+15],22,1236535329);a=gg(a,b,c,d,x[i+1],5,-165796510);d=gg(d,a,b,c,x[i+6],9,-1069501632);c=gg(c,d,a,b,x[i+11],14,643717713);b=gg(b,c,d,a,x[i+0],20,-373897302);a=gg(a,b,c,d,x[i+5],5,-701558691);d=gg(d,a,b,c,x[i+10],9,38016083);c=gg(c,d,a,b,x[i+15],14,-660478335);b=gg(b,c,d,a,x[i+4],20,-405537848);a=gg(a,b,c,d,x[i+9],5,568446438);d=gg(d,a,b,c,x[i+14],9,-1019803690);c=gg(c,d,a,b,x[i+3],14,-187363961);b=gg(b,c,d,a,x[i+8],20,1163531501);a=gg(a,b,c,d,x[i+13],5,-1444681467);d=gg(d,a,b,c,x[i+2],9,-51403784);c=gg(c,d,a,b,x[i+7],14,1735328473);b=gg(b,c,d,a,x[i+12],20,-1926607734);a=hh(a,b,c,d,x[i+5],4,-378558);d=hh(d,a,b,c,x[i+8],11,-2022574463);c=hh(c,d,a,b,x[i+11],16,1839030562);b=hh(b,c,d,a,x[i+14],23,-35309556);a=hh(a,b,c,d,x[i+1],4,-1530992060);d=hh(d,a,b,c,x[i+4],11,1272893353);c=hh(c,d,a,b,x[i+7],16,-155497632);b=hh(b,c,d,a,x[i+10],23,-1094730640);a=hh(a,b,c,d,x[i+13],4,681279174);d=hh(d,a,b,c,x[i+0],11,-358537222);c=hh(c,d,a,b,x[i+3],16,-722521979);b=hh(b,c,d,a,x[i+6],23,76029189);a=hh(a,b,c,d,x[i+9],4,-640364487);d=hh(d,a,b,c,x[i+12],11,-421815835);c=hh(c,d,a,b,x[i+15],16,530742520);b=hh(b,c,d,a,x[i+2],23,-995338651);a=ii(a,b,c,d,x[i+0],6,-198630844);d=ii(d,a,b,c,x[i+7],10,1126891415);c=ii(c,d,a,b,x[i+14],15,-1416354905);b=ii(b,c,d,a,x[i+5],21,-57434055);a=ii(a,b,c,d,x[i+12],6,1700485571);d=ii(d,a,b,c,x[i+3],10,-1894986606);c=ii(c,d,a,b,x[i+10],15,-1051523);b=ii(b,c,d,a,x[i+1],21,-2054922799);a=ii(a,b,c,d,x[i+8],6,1873313359);d=ii(d,a,b,c,x[i+15],10,-30611744);c=ii(c,d,a,b,x[i+6],15,-1560198380);b=ii(b,c,d,a,x[i+13],21,1309151649);a=ii(a,b,c,d,x[i+4],6,-145523070);d=ii(d,a,b,c,x[i+11],10,-1120210379);c=ii(c,d,a,b,x[i+2],15,718787259);b=ii(b,c,d,a,x[i+9],21,-343485551);a=addme(a,olda);b=addme(b,oldb);c=addme(c,oldc);d=addme(d,oldd)}return rhex(a)+rhex(b)+rhex(c)+rhex(d)}};function _utf8_encode(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}return utftext}function bitOR(a,b){var lsb=(a&0x1)|(b&0x1);var msb31=(a>>>1)|(b>>>1);return(msb31<<1)|lsb}function bitXOR(a,b){var lsb=(a&0x1)^(b&0x1);var msb31=(a>>>1)^(b>>>1);return(msb31<<1)|lsb}function bitAND(a,b){var lsb=(a&0x1)&(b&0x1);var msb31=(a>>>1)&(b>>>1);return(msb31<<1)|lsb}function addme(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF)}function rhex(num){var str="";var j;for(j=0;j<=3;j++)str+=hex_chr.charAt((num>>(j*8+4))&0x0F)+hex_chr.charAt((num>>(j*8))&0x0F);return str}function str2blks_MD5(str){var nblk=((str.length+8)>>6)+1;var blks=new Array(nblk*16);var i;for(i=0;i<nblk*16;i++)blks[i]=0;for(i=0;i<str.length;i++)blks[i>>2]|=str.charCodeAt(i)<<(((str.length*8+i)%4)*8);blks[i>>2]|=0x80<<(((str.length*8+i)%4)*8);var l=str.length*8;blks[nblk*16-2]=(l&0xFF);blks[nblk*16-2]|=((l>>>8)&0xFF)<<8;blks[nblk*16-2]|=((l>>>16)&0xFF)<<16;blks[nblk*16-2]|=((l>>>24)&0xFF)<<24;return blks}function rol(num,cnt){return(num<<cnt)|(num>>>(32-cnt))}function cmn(q,a,b,x,s,t){return addme(rol((addme(addme(a,q),addme(x,t))),s),b)}function ff(a,b,c,d,x,s,t){return cmn(bitOR(bitAND(b,c),bitAND((~b),d)),a,b,x,s,t)}function gg(a,b,c,d,x,s,t){return cmn(bitOR(bitAND(b,d),bitAND(c,(~d))),a,b,x,s,t)}function hh(a,b,c,d,x,s,t){return cmn(bitXOR(bitXOR(b,c),d),a,b,x,s,t)}function ii(a,b,c,d,x,s,t){return cmn(bitXOR(c,bitOR(b,(~d))),a,b,x,s,t)}}())}());if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?'0'+n:n}if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key)}if(typeof rep==='function'){value=rep.call(holder,key,value)}switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null'}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null'}v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v}if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v)}}}}v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v}}if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' '}}else if(typeof space==='string'){indent=space}rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify')}return str('',{'':value})}}if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j}throw new SyntaxError('JSON.parse')}}}());